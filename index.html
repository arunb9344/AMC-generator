<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMC Agreement Generator - Eye Tech Securities</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }
        .form-section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .form-section h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        .input-field {
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.5rem;
            width: 100%;
            margin-bottom: 1rem;
        }
        .particular-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: center;
        }
        .particular-row input {
            flex: 1;
        }
        .btn-primary {
            background-color: #2563eb;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .btn-secondary {
            background-color: #6b7280;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
        }
        .btn-secondary:hover {
            background-color: #4b5563;
        }
        .logo-placeholder {
            text-align: center;
            margin-bottom: 1rem;
        }
        #total-amount {
            font-weight: 600;
            color: #1f2937;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-placeholder">
            <img src="https://via.placeholder.com/150x50?text=Eye+Tech+Securities+Logo" alt="Eye Tech Securities Logo">
        </div>
        <div class="form-section">
            <h1 class="text-2xl font-bold text-center text-gray-800 mb-6">AMC Agreement Generator</h1>
            <form id="amc-form">
                <div class="form-section">
                    <h2>Customer Details</h2>
                    <label for="customer-name" class="block text-sm font-medium text-gray-700">Customer Name</label>
                    <input type="text" id="customer-name" class="input-field" required>

                    <label for="customer-address" class="block text-sm font-medium text-gray-700">Customer Address</label>
                    <input type="text" id="customer-address" class="input-field" required>

                    <label for="customer-contact" class="block text-sm font-medium text-gray-700">Customer Contact Number</label>
                    <input type="text" id="customer-contact" class="input-field" required>

                    <label for="customer-email" class="block text-sm font-medium text-gray-700">Customer Email</label>
                    <input type="email" id="customer-email" class="input-field" required>
                </div>

                <div class="form-section mt-6">
                    <h2>Contract Details</h2>
                    <label for="contract-period" class="block text-sm font-medium text-gray-700">Contract Period (Years)</label>
                    <select id="contract-period" class="input-field" required>
                        <option value="1">1 Year</option>
                        <option value="2">2 Years</option>
                        <option value="3">3 Years</option>
                        <option value="4">4 Years</option>
                        <option value="5">5 Years</option>
                    </select>
                </div>

                <div class="form-section mt-6">
                    <h2>Particulars</h2>
                    <div id="particulars-container"></div>
                    <button type="button" onclick="addParticularRow()" class="btn-secondary mt-4">Add Particular</button>
                    <div id="total-amount">Total Amount: ₹0</div>
                </div>

                <button type="button" onclick="generatePDF()" class="btn-primary mt-6 w-full">Generate PDF</button>
            </form>
        </div>
    </div>

    <script>
        function addParticularRow() {
            const container = document.getElementById('particulars-container');
            const row = document.createElement('div');
            row.className = 'particular-row';
            row.innerHTML = `
                <input type="text" placeholder="Particular (e.g., CCTV, Biometrics)" class="input-field" required>
                <input type="number" placeholder="Maintenance Visits" min="0" class="input-field" required>
                <input type="number" placeholder="Breakdown Visits" min="0" class="input-field" required>
                <input type="number" placeholder="Amount (₹)" min="0" step="0.01" class="input-field" required>
                <button type="button" onclick="this.parentNode.remove(); updateTotalAmount()" class="btn-secondary">Remove</button>
            `;
            container.appendChild(row);
            row.querySelectorAll('input[type="number"]').forEach(input => {
                input.addEventListener('input', updateTotalAmount);
            });
        }

        function updateTotalAmount() {
            const rows = document.querySelectorAll('.particular-row');
            let total = 0;
            rows.forEach(row => {
                const amountInput = row.querySelector('input[placeholder="Amount (₹)"]');
                if (amountInput && amountInput.value) {
                    total += parseFloat(amountInput.value) || 0;
                }
            });
            document.getElementById('total-amount').textContent = `Total Amount: ₹${total.toFixed(2)}`;
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Header on every page
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(20);
            doc.setTextColor(31, 41, 55); // Gray-800
            doc.text('Eye Tech Securities', 105, 20, { align: 'center' });
            doc.setFontSize(16);
            doc.text('Annual Maintenance Contract (AMC) Agreement', 105, 30, { align: 'center' });
            doc.setDrawColor(37, 99, 235); // Blue-600
            doc.setLineWidth(0.5);
            doc.line(20, 35, 190, 35); // Horizontal line
            doc.setFontSize(10);
            doc.setTextColor(107, 114, 128); // Gray-500
            doc.text('123 Security Lane, Tech City, India | support@eyetechsecurities.com | +91-XXX-XXX-XXXX', 105, 40, { align: 'center' });

            // Footer on every page
            doc.setFontSize(10);
            doc.setTextColor(107, 114, 128); // Gray-500
            doc.addPage = function() {
                const pageCount = doc.internal.getNumberOfPages();
                PDFDocument.prototype.addPage.apply(this, arguments);
                doc.setPage(pageCount + 1);
                doc.setFontSize(10);
                doc.setTextColor(107, 114, 128);
                doc.text(`Page ${doc.internal.getCurrentPageInfo().pageNumber}`, 190, 280, { align: 'right' });
                doc.text('Eye Tech Securities | support@eyetechsecurities.com | +91-XXX-XXX-XXXX', 105, 280, { align: 'center' });
                // Repeat header on new pages
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(20);
                doc.setTextColor(31, 41, 55);
                doc.text('Eye Tech Securities', 105, 20, { align: 'center' });
                doc.setFontSize(16);
                doc.text('Annual Maintenance Contract (AMC) Agreement', 105, 30, { align: 'center' });
                doc.setDrawColor(37, 99, 235);
                doc.setLineWidth(0.5);
                doc.line(20, 35, 190, 35);
                doc.setFontSize(10);
                doc.setTextColor(107, 114, 128);
                doc.text('123 Security Lane, Tech City, India | support@eyetechsecurities.com | +91-XXX-XXX-XXXX', 105, 40, { align: 'center' });
            };

            // AMC Number and Date
            const today = new Date();
            const year = today.getFullYear();
            const randomSuffix = Math.floor(Math.random() * 900) + 100;
            const amcNumber = `ETS-AMC-${year}-${randomSuffix.toString().padStart(3, '0')}`;
            const amcDate = today.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });

            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(55, 65, 81); // Gray-700
            doc.text(`AMC Number: ${amcNumber}`, 20, 55);
            doc.text(`AMC Date: ${amcDate}`, 20, 63);

            // Customer Details
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Customer Details', 20, 80);
            doc.setLineWidth(0.2);
            doc.line(20, 82, 60, 82); // Underline
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            const customerName = document.getElementById('customer-name').value;
            const customerAddress = document.getElementById('customer-address').value;
            const customerContact = document.getElementById('customer-contact').value;
            const customerEmail = document.getElementById('customer-email').value;
            doc.text(`Name: ${customerName}`, 20, 90);
            doc.text(`Address: ${customerAddress}`, 20, 98);
            doc.text(`Contact: ${customerContact}`, 20, 106);
            doc.text(`Email: ${customerEmail}`, 20, 114);

            // Contract Period
            const contractPeriod = parseInt(document.getElementById('contract-period').value);
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Contract Details', 20, 130);
            doc.line(20, 132, 60, 132); // Underline
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text(`Contract Period: ${contractPeriod} Year(s)`, 20, 140);

            // Particulars Table
            const particulars = [];
            let totalAmount = 0;
            const rows = document.querySelectorAll('.particular-row');
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                if (inputs.length === 4) {
                    const amount = parseFloat(inputs[3].value) || 0;
                    totalAmount += amount;
                    particulars.push([
                        inputs[0].value,
                        inputs[1].value,
                        inputs[2].value,
                        `₹${amount.toFixed(2)}`
                    ]);
                }
            });

            if (particulars.length > 0) {
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.text('Particulars', 20, 155);
                doc.line(20, 157, 50, 157); // Underline
                doc.autoTable({
                    startY: 165,
                    head: [['Item', 'Maintenance Visits', 'Breakdown Visits', 'Amount (₹)']],
                    body: [...particulars, ['', '', 'Total:', `₹${totalAmount.toFixed(2)}`]],
                    theme: 'grid',
                    styles: { fontSize: 10, cellPadding: 4, textColor: [55, 65, 81] },
                    headStyles: { fillColor: [37, 99, 235], textColor: [255, 255, 255], fontStyle: 'bold' },
                    columnStyles: {
                        0: { cellWidth: 60 },
                        1: { cellWidth: 40 },
                        2: { cellWidth: 40 },
                        3: { cellWidth: 40 }
                    },
                    footStyles: { fillColor: [241, 245, 249], textColor: [31, 41, 55], fontStyle: 'bold' },
                    didParseCell: (data) => {
                        if (data.row.index === particulars.length && data.column.index === 2) {
                            data.cell.text = ['Total:'];
                        }
                    }
                });
            }

            // Terms and Conditions
            let startY = doc.lastAutoTable ? doc.lastAutoTable.finalY + 20 : 155;
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Terms and Conditions', 20, startY);
            doc.line(20, startY + 2, 70, startY + 2); // Underline
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            const terms = [
                `1. The contract is applicable for ${contractPeriod * 12} months from the agreement date.`,
                '2. Contract does not cover damages due to natural disasters, misuse, etc.',
                '3. Offer valid for 30 days from issue date.',
                '4. Equipment must be in working condition; customer to bear initial repair cost.',
                '5. Customer must provide ladder, water, power, and civil support.',
                '6. Missing/stolen items are customer’s liability.',
                '7. Customer must allow access during maintenance. No refund if missed.',
                '8. Breakdown visits only during working hours (Mon–Sat).',
                '9. Contract is non-transferable and non-terminable.',
                '10. Payment due within 30 days, else 2% monthly penalty applies.',
                '11. Maintenance visits include cleaning, adjustments, checks.',
                '12. Only registered complaints are addressed in breakdown visits.',
                '13. Warranty covered items only will be processed.',
                '14. Material replacements are chargeable unless under warranty.',
                '15. Connector replacement (Rs.500/camera) included in first visit.'
            ];
            let currentY = startY + 10;
            terms.forEach((term) => {
                const lines = doc.splitTextToSize(term, 170);
                if (currentY + lines.length * 8 > 260) {
                    doc.addPage();
                    currentY = 50;
                }
                doc.text(lines, 20, currentY);
                currentY += lines.length * 8;
            });

            // Signatures
            if (currentY + 30 > 260) {
                doc.addPage();
                currentY = 50;
            }
            doc.setFontSize(12);
            doc.text('Customer Signature: _______________________', 20, currentY);
            doc.text('Eye Tech Securities Signature: _______________________', 110, currentY);

            // Save PDF
            doc.save(`AMC_Agreement_${amcNumber}.pdf`);
        }

        // Add one particular row by default
        addParticularRow();

        // Update total amount on page load
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', updateTotalAmount);
        });
    </script>
</body>
</html>
