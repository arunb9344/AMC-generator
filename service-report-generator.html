<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Report Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Helvetica', Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 15px;
            background-color: #f5f7fa;
        }
        h1 {
            text-align: center;
            color: #1a3c6d;
            font-size: 22px;
            margin-bottom: 15px;
        }
        .tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }
        .tabs a {
            padding: 10px 20px;
            text-decoration: none;
            color: #fff;
            background-color: #1a3c6d;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .tabs a:hover {
            background-color: #153057;
        }
        .form-section {
            background-color: #fff;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 6px;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
        }
        .form-section h2 {
            color: #1a3c6d;
            font-size: 14px;
            margin-bottom: 10px;
            border-bottom: 1px solid #1a3c6d;
            padding-bottom: 3px;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            margin-bottom: 3px;
            font-weight: 600;
            color: #333;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 6px;
            border: 1px solid #d0d4db;
            border-radius: 3px;
            font-size: 12px;
        }
        .checklist {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }
        .checklist label {
            display: flex;
            align-items: center;
            font-size: 12px;
        }
        .checklist input[type="checkbox"] {
            margin-right: 5px;
        }
        .generate-btn {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #e74c3c;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .generate-btn:hover {
            background-color: #c0392b;
        }
    </style>
</head>
<body>
    <h1>Service Report Generator</h1>
    <div class="tabs">
        <a href="#">AMC Agreement</a>
        <a href="#">Service Report</a>
    </div>

    <div class="form-section">
        <h2>Customer Details</h2>
        <div class="form-group">
            <label for="customer-name">Customer Name</label>
            <input type="text" id="customer-name" placeholder="Enter customer name">
        </div>
        <div class="form-group">
            <label for="customer-address">Customer Address</label>
            <input type="text" id="customer-address" placeholder="Enter customer address">
        </div>
        <div class="form-group">
            <label for="contact-person">Contact Person</label>
            <input type="text" id="contact-person" placeholder="Enter contact person">
        </div>
        <div class="form-group">
            <label for="customer-contact">Customer Contact Number</label>
            <input type="text" id="customer-contact" placeholder="Enter contact number">
        </div>
        <div class="form-group">
            <label for="customer-email">Customer Email</label>
            <input type="email" id="customer-email" placeholder="Enter email address">
        </div>
    </div>

    <div class="form-section">
        <h2>Service Details</h2>
        <div class="form-group">
            <label for="service-type">Service Type</label>
            <select id="service-type">
                <option value="">Select Service Type</option>
                <option value="Maintenance Visit">Maintenance Visit</option>
                <option value="Breakdown Visit">Breakdown Visit</option>
            </select>
        </div>
        <div class="form-group">
            <label for="equipment-type">Equipment Type</label>
            <select id="equipment-type" onchange="toggleChecklists()">
                <option value="">Select Equipment Type</option>
                <option value="CCTV">CCTV</option>
                <option value="Biometrics & Access Control">Biometrics & Access Control</option>
                <option value="Video Door Bell">Video Door Bell</option>
                <option value="Fire Alarm">Fire Alarm</option>
            </select>
        </div>
        <div class="form-group">
            <label for="service-date">Service Date</label>
            <input type="date" id="service-date">
        </div>
        <div class="form-group">
            <label for="technician-name">Technician Name</label>
            <input type="text" id="technician-name" placeholder="Enter technician name">
        </div>
    </div>

    <div class="form-section" id="cctv-checklist" style="display: none;">
        <h2>CCTV Maintenance Checklist</h2>
        <div class="checklist">
            <label><input type="checkbox" id="cameras-live"> Cameras Live</label>
            <label><input type="checkbox" id="playback-working"> Playback Working</label>
            <label><input type="checkbox" id="hdd-healthy"> HDD Healthy</label>
            <label><input type="checkbox" id="date-time-accurate"> Date/Time Accurate</label>
            <label><input type="checkbox" id="remote-access"> Remote Access</label>
            <label><input type="checkbox" id="power-supply"> Power Supply</label>
            <label><input type="checkbox" id="lenses-clean"> Lenses Clean</label>
            <label><input type="checkbox" id="cables-secure"> Cables Secure</label>
        </div>
    </div>

    <div class="form-section" id="biometrics-checklist" style="display: none;">
        <h2>Biometrics & Access Control Checklist</h2>
        <div class="checklist">
            <label><input type="checkbox" id="fingerprint-working"> Fingerprint Scanner Working</label>
            <label><input type="checkbox" id="card-reader-working"> Card Reader Working</label>
            <label><input type="checkbox" id="door-lock-mechanism"> Door Lock Mechanism</label>
            <label><input type="checkbox" id="access-logs-updated"> Access Logs Updated</label>
            <label><input type="checkbox" id="user-database-backup"> User Database Backup</label>
            <label><input type="checkbox" id="sensor-calibration"> Sensor Calibration</label>
        </div>
    </div>

    <div class="form-section" id="video-doorbell-checklist" style="display: none;">
        <h2>Video Door Bell Checklist</h2>
        <div class="checklist">
            <label><input type="checkbox" id="video-quality-clear"> Video Quality Clear</label>
            <label><input type="checkbox" id="audio-quality-clear"> Audio Quality Clear</label>
            <label><input type="checkbox" id="motion-detection-working"> Motion Detection Working</label>
            <label><input type="checkbox" id="night-vision-working"> Night Vision Working</label>
            <label><input type="checkbox" id="mobile-app-connectivity"> Mobile App Connectivity</label>
            <label><input type="checkbox" id="doorbell-chime-working"> Doorbell Chime Working</label>
        </div>
    </div>

    <div class="form-section" id="fire-alarm-checklist" style="display: none;">
        <h2>Fire Alarm System Checklist</h2>
        <div class="checklist">
            <label><input type="checkbox" id="smoke-detectors-working"> Smoke Detectors Working</label>
            <label><input type="checkbox" id="heat-detectors-working"> Heat Detectors Working</label>
            <label><input type="checkbox" id="alarm-sounders-working"> Alarm Sounders Working</label>
            <label><input type="checkbox" id="control-panel-functional"> Control Panel Functional</label>
            <label><input type="checkbox" id="battery-backup-tested"> Battery Backup Tested</label>
            <label><input type="checkbox" id="manual-call-points-working"> Manual Call Points Working</label>
        </div>
    </div>

    <div class="form-section">
        <h2>Issue Description</h2>
        <div class="form-group">
            <label for="issue-description">Issue Description</label>
            <textarea id="issue-description" rows="3" placeholder="Describe any issues"></textarea>
        </div>
    </div>

    <div class="form-section">
        <h2>Technician Comments</h2>
        <div class="form-group">
            <label for="technician-comments">Technician Comments</label>
            <textarea id="technician-comments" rows="3" placeholder="Enter technician comments"></textarea>
        </div>
    </div>

    <button class="generate-btn" onclick="generatePDF()">Generate Service Report PDF</button>

    <script>
        const { jsPDF } = window.jspdf;

        function toggleChecklists() {
            const equipmentType = document.getElementById('equipment-type').value;
            const checklists = [
                'cctv-checklist',
                'biometrics-checklist',
                'video-doorbell-checklist',
                'fire-alarm-checklist'
            ];
            checklists.forEach(checklist => {
                document.getElementById(checklist).style.display = 'none';
            });
            if (equipmentType) {
                document.getElementById(equipmentType.toLowerCase().replace(/ & /g, '-').replace(/ /g, '-') + '-checklist').style.display = 'block';
            }
        }

        function generatePDF() {
            const doc = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });

            // Set document properties
            doc.setProperties({
                title: 'Service Report',
                author: 'Eye Tech Securities',
                creator: 'Service Report Generator'
            });

            // Company Header
            doc.setFillColor(26, 60, 109); // Dark Blue
            doc.rect(0, 0, 210, 25, 'F');
            doc.setFont('Helvetica', 'bold');
            doc.setFontSize(14);
            doc.setTextColor(255, 255, 255);
            doc.text('Eye Tech Securities', 10, 15);
            doc.setFontSize(8);
            doc.setFont('Helvetica', 'normal');
            doc.text('No.36/80, Medavakkam Main Road, Keelkattalai, Chennai, Tamil Nadu 600113', 10, 20);
            doc.text('Phone: +91916218229 | Email: eyetecsecurities@gmail.com', 10, 24);

            // Title
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.setFont('Helvetica', 'bold');
            doc.text('Service Report', 105, 35, null, null, 'center');

            // Customer Details Table
            doc.setFontSize(9);
            doc.setFont('Helvetica', 'bold');
            doc.text('Customer Details', 10, 45);
            doc.setDrawColor(26, 60, 109);
            doc.setLineWidth(0.2);
            doc.line(10, 47, 200, 47);

            doc.autoTable({
                startY: 50,
                head: [['Field', 'Details']],
                body: [
                    ['Customer Name', document.getElementById('customer-name').value || 'N/A'],
                    ['Address', document.getElementById('customer-address').value || 'N/A'],
                    ['Contact Person', document.getElementById('contact-person').value || 'N/A'],
                    ['Contact Number', document.getElementById('customer-contact').value || 'N/A'],
                    ['Email', document.getElementById('customer-email').value || 'N/A']
                ],
                theme: 'grid',
                headStyles: {
                    fillColor: [26, 60, 109],
                    textColor: [255, 255, 255],
                    fontSize: 7,
                    fontStyle: 'bold'
                },
                bodyStyles: {
                    fontSize: 6,
                    textColor: [0, 0, 0]
                },
                margin: { left: 10, right: 10 },
                tableWidth: 180,
                rowPageBreak: 'avoid'
            });

            let y = doc.lastAutoTable.finalY + 3;

            // Service Details Table
            doc.setFontSize(9);
            doc.setFont('Helvetica', 'bold');
            doc.text('Service Details', 10, y);
            doc.line(10, y + 2, 200, y + 2);
            doc.autoTable({
                startY: y + 3,
                head: [['Field', 'Details']],
                body: [
                    ['Service Type', document.getElementById('service-type').value || 'N/A'],
                    ['Equipment Type', document.getElementById('equipment-type').value || 'N/A'],
                    ['Service Date', document.getElementById('service-date').value || 'N/A'],
                    ['Technician Name', document.getElementById('technician-name').value || 'N/A']
                ],
                theme: 'grid',
                headStyles: {
                    fillColor: [26, 60, 109],
                    textColor: [255, 255, 255],
                    fontSize: 7,
                    fontStyle: 'bold'
                },
                bodyStyles: {
                    fontSize: 6,
                    textColor: [0, 0, 0]
                },
                margin: { left: 10, right: 10 },
                tableWidth: 180,
                rowPageBreak: 'avoid'
            });

            y = doc.lastAutoTable.finalY + 3;

            // Checklist
            const equipmentType = document.getElementById('equipment-type').value;
            let checklistItems = [];
            if (equipmentType === 'CCTV') {
                checklistItems = [
                    ['Cameras Live', document.getElementById('cameras-live').checked ? 'Yes' : 'No'],
                    ['Playback Working', document.getElementById('playback-working').checked ? 'Yes' : 'No'],
                    ['HDD Healthy', document.getElementById('hdd-healthy').checked ? 'Yes' : 'No'],
                    ['Date/Time Accurate', document.getElementById('date-time-accurate').checked ? 'Yes' : 'No'],
                    ['Remote Access', document.getElementById('remote-access').checked ? 'Yes' : 'No'],
                    ['Power Supply', document.getElementById('power-supply').checked ? 'Yes' : 'No'],
                    ['Lenses Clean', document.getElementById('lenses-clean').checked ? 'Yes' : 'No'],
                    ['Cables Secure', document.getElementById('cables-secure').checked ? 'Yes' : 'No']
                ];
            } else if (equipmentType === 'Biometrics & Access Control') {
                checklistItems = [
                    ['Fingerprint Scanner Working', document.getElementById('fingerprint-working').checked ? 'Yes' : 'No'],
                    ['Card Reader Working', document.getElementById('card-reader-working').checked ? 'Yes' : 'No'],
                    ['Door Lock Mechanism', document.getElementById('door-lock-mechanism').checked ? 'Yes' : 'No'],
                    ['Access Logs Updated', document.getElementById('access-logs-updated').checked ? 'Yes' : 'No'],
                    ['User Database Backup', document.getElementById('user-database-backup').checked ? 'Yes' : 'No'],
                    ['Sensor Calibration', document.getElementById('sensor-calibration').checked ? 'Yes' : 'No']
                ];
            } else if (equipmentType === 'Video Door Bell') {
                checklistItems = [
                    ['Video Quality Clear', document.getElementById('video-quality-clear').checked ? 'Yes' : 'No'],
                    ['Audio Quality Clear', document.getElementById('audio-quality-clear').checked ? 'Yes' : 'No'],
                    ['Motion Detection Working', document.getElementById('motion-detection-working').checked ? 'Yes' : 'No'],
                    ['Night Vision Working', document.getElementById('night-vision-working').checked ? 'Yes' : 'No'],
                    ['Mobile App Connectivity', document.getElementById('mobile-app-connectivity').checked ? 'Yes' : 'No'],
                    ['Doorbell Chime Working', document.getElementById('doorbell-chime-working').checked ? 'Yes' : 'No']
                ];
            } else if (equipmentType === 'Fire Alarm') {
                checklistItems = [
                    ['Smoke Detectors Working', document.getElementById('smoke-detectors-working').checked ? 'Yes' : 'No'],
                    ['Heat Detectors Working', document.getElementById('heat-detectors-working').checked ? 'Yes' : 'No'],
                    ['Alarm Sounders Working', document.getElementById('alarm-sounders-working').checked ? 'Yes' : 'No'],
                    ['Control Panel Functional', document.getElementById('control-panel-functional').checked ? 'Yes' : 'No'],
                    ['Battery Backup Tested', document.getElementById('battery-backup-tested').checked ? 'Yes' : 'No'],
                    ['Manual Call Points Working', document.getElementById('manual-call-points-working').checked ? 'Yes' : 'No']
                ];
            }

            if (checklistItems.length > 0) {
                doc.setFontSize(9);
                doc.setFont('Helvetica', 'bold');
                doc.text(`${equipmentType} Checklist`, 10, y);
                doc.line(10, y + 2, 200, y + 2);
                doc.autoTable({
                    startY: y + 3,
                    head: [['Item', 'Status']],
                    body: checklistItems,
                    theme: 'grid',
                    headStyles: {
                        fillColor: [26, 60, 109],
                        textColor: [255, 255, 255],
                        fontSize: 6,
                        fontStyle: 'bold'
                    },
                    bodyStyles: {
                        fontSize: 5,
                        textColor: [0, 0, 0]
                    },
                    margin: { left: 10, right: 10 },
                    tableWidth: 180,
                    rowPageBreak: 'avoid'
                });
                y = doc.lastAutoTable.finalY + 3;
            }

            // Issue Description
            const issueDescription = document.getElementById('issue-description').value;
            if (issueDescription) {
                doc.setFontSize(9);
                doc.setFont('Helvetica', 'bold');
                doc.text('Issue Description', 10, y);
                doc.line(10, y + 2, 200, y + 2);
                doc.setFont('Helvetica', 'normal');
                doc.setFontSize(6);
                const textLines = doc.splitTextToSize(issueDescription, 180);
                doc.text(textLines, 10, y + 4, { maxWidth: 180 });
                y += 4 + 4 * Math.min(textLines.length, 3); // Limit to 3 lines to fit page
            }

            // Technician Comments
            const technicianComments = document.getElementById('technician-comments').value;
            if (technicianComments) {
                doc.setFontSize(9);
                doc.setFont('Helvetica', 'bold');
                doc.text('Technician Comments', 10, y);
                doc.line(10, y + 2, 200, y + 2);
                doc.setFont('Helvetica', 'normal');
                doc.setFontSize(6);
                const textLines = doc.splitTextToSize(technicianComments, 180);
                doc.text(textLines, 10, y + 4, { maxWidth: 180 });
                y += 4 + 4 * Math.min(textLines.length, 3); // Limit to 3 lines to fit page
            }

            // Footer (adjusted to avoid overlap)
            const footerY = Math.min(y + 10, 260); // Ensure footer starts before page end
            doc.setFillColor(26, 60, 109);
            doc.rect(0, footerY, 210, 27, 'F');
            doc.setFontSize(7);
            doc.setTextColor(255, 255, 255);
            doc.setFont('Helvetica', 'normal');
            doc.text('Eye Tech Securities | No.36/80, Medavakkam Main Road, Keelkattalai, Chennai, Tamil Nadu 600113', 10, footerY + 5);
            doc.text('Phone: +91916218229 | Email: eyetecsecurities@gmail.com | www.eyetecsecurities.in', 10, footerY + 10);

            // Save the PDF
            doc.save('Service_Report.pdf');
        }
    </script>
</body>
</html>
